2026-02-21 18:58:15,372 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 18:58:15,545 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 18:58:15,573 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 18:59:08,968 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 18:59:09,073 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 18:59:09,095 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 18:59:11,073 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 18:59:11,204 ERROR etl_inversiones Error crítico en la carga histórica: 'periodo'
Traceback (most recent call last):
  File "/home/dcuasapaz/git/poc-bancs-inversion/poc-bancs-inversion-venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3641, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 168, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 197, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7668, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7676, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'periodo'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/tmp/ipykernel_16077/255889280.py", line 23, in cargar_datos_historicos_postgresql
    periodos_en_datos = df[campo_particion].unique()
                        ~~^^^^^^^^^^^^^^^^^
  File "/home/dcuasapaz/git/poc-bancs-inversion/poc-bancs-inversion-venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4378, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dcuasapaz/git/poc-bancs-inversion/poc-bancs-inversion-venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3648, in get_loc
    raise KeyError(key) from err
KeyError: 'periodo'
2026-02-21 19:02:36,232 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 19:02:36,365 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:02:36,403 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:02:39,068 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:02:39,202 ERROR etl_inversiones Error crítico en la carga histórica: 'periodo'
Traceback (most recent call last):
  File "/home/dcuasapaz/git/poc-bancs-inversion/poc-bancs-inversion-venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3641, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 168, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 197, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7668, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7676, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'periodo'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/tmp/ipykernel_16077/255889280.py", line 23, in cargar_datos_historicos_postgresql
    periodos_en_datos = df[campo_particion].unique()
                        ~~^^^^^^^^^^^^^^^^^
  File "/home/dcuasapaz/git/poc-bancs-inversion/poc-bancs-inversion-venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4378, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dcuasapaz/git/poc-bancs-inversion/poc-bancs-inversion-venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3648, in get_loc
    raise KeyError(key) from err
KeyError: 'periodo'
2026-02-21 19:05:09,701 INFO etl_inversiones Ejecutando diagnóstico rápido del notebook
2026-02-21 19:05:09,721 INFO etl_inversiones Diagnóstico completado
2026-02-21 19:05:09,763 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 19:05:09,878 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:05:09,915 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:05:12,378 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:05:12,498 ERROR etl_inversiones Error crítico en la carga histórica: 'periodo'
Traceback (most recent call last):
  File "/home/dcuasapaz/git/poc-bancs-inversion/poc-bancs-inversion-venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3641, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 168, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 197, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7668, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7676, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'periodo'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/tmp/ipykernel_16077/255889280.py", line 23, in cargar_datos_historicos_postgresql
    periodos_en_datos = df[campo_particion].unique()
                        ~~^^^^^^^^^^^^^^^^^
  File "/home/dcuasapaz/git/poc-bancs-inversion/poc-bancs-inversion-venv/lib/python3.12/site-packages/pandas/core/frame.py", line 4378, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dcuasapaz/git/poc-bancs-inversion/poc-bancs-inversion-venv/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3648, in get_loc
    raise KeyError(key) from err
KeyError: 'periodo'
2026-02-21 19:07:48,625 INFO etl_inversiones Ejecutando diagnóstico rápido del notebook
2026-02-21 19:07:48,633 INFO etl_inversiones Diagnóstico completado
2026-02-21 19:07:48,670 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 19:07:48,849 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:07:48,880 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:07:51,738 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:08:58,867 INFO etl_inversiones Ejecutando diagnóstico rápido del notebook
2026-02-21 19:08:58,881 INFO etl_inversiones Diagnóstico completado
2026-02-21 19:08:58,915 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 19:08:59,074 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:08:59,117 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:09:01,132 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:10:28,331 INFO etl_inversiones Ejecutando diagnóstico rápido del notebook
2026-02-21 19:10:28,342 INFO etl_inversiones Diagnóstico completado
2026-02-21 19:10:28,365 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 19:10:28,472 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:10:28,507 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:10:30,944 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:11:15,096 INFO etl_inversiones Ejecutando diagnóstico rápido del notebook
2026-02-21 19:11:15,102 INFO etl_inversiones Diagnóstico completado
2026-02-21 19:12:15,516 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 19:12:33,425 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:12:33,464 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:13:26,920 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:21:29,763 INFO etl_inversiones Ejecutando diagnóstico rápido del notebook
2026-02-21 19:21:29,773 INFO etl_inversiones Diagnóstico completado
2026-02-21 19:21:29,802 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 19:21:29,907 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:21:29,938 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:21:32,937 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:36:15,117 INFO etl_inversiones Ejecutando diagnóstico rápido del notebook
2026-02-21 19:36:15,125 INFO etl_inversiones Diagnóstico completado
2026-02-21 19:36:15,156 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 19:36:15,240 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:36:15,273 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:36:17,954 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:42:36,800 INFO etl_inversiones Ejecutando diagnóstico rápido del notebook
2026-02-21 19:42:36,868 INFO etl_inversiones Diagnóstico completado
2026-02-21 19:42:37,390 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 19:42:39,302 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:42:39,322 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:42:42,267 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:43:00,193 INFO etl_inversiones Ejecutando diagnóstico rápido del notebook
2026-02-21 19:43:00,197 INFO etl_inversiones Diagnóstico completado
2026-02-21 19:43:00,794 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 19:43:03,390 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:43:03,410 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:43:06,648 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:45:12,542 INFO etl_inversiones Ejecutando diagnóstico rápido del notebook
2026-02-21 19:45:12,548 INFO etl_inversiones Diagnóstico completado
2026-02-21 19:45:12,584 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 19:45:12,674 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:45:12,706 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:45:14,878 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:51:15,486 INFO etl_inversiones Ejecutando diagnóstico rápido del notebook
2026-02-21 19:51:15,491 INFO etl_inversiones Diagnóstico completado
2026-02-21 19:51:15,518 INFO etl_inversiones Logging initialized for inversiones notebook
2026-02-21 19:51:15,609 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:51:15,660 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:51:17,925 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:51:48,310 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:51:48,342 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:51:50,846 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:52:33,868 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
2026-02-21 19:59:51,999 INFO etl_inversiones Secure engine created for localhost:5432/db_poc_bancs
2026-02-21 19:59:52,034 INFO etl_inversiones ✅ Conexión exitosa con el engine seguro.
2026-02-21 19:59:54,841 INFO etl_inversiones Archivo generado exitosamente en Zona Raw: ../data/raw/zr_fake_pas_inversiones.csv
